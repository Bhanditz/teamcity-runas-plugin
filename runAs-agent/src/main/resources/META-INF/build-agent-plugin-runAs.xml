<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"
       default-autowire="constructor">

  <bean class="jetbrains.buildServer.runAs.agent.BuildFeatureParametersServiceImpl" />
  <bean class="jetbrains.buildServer.runAs.agent.CommandLineExecutorImpl" />
  <bean class="jetbrains.buildServer.runAs.agent.RunAsPropertiesExtension" />
  <bean class="jetbrains.buildServer.runAs.agent.RunAsToolProvider" />
  <bean class="jetbrains.buildServer.runAs.agent.FileAccessServiceImpl"/>
  <bean class="jetbrains.buildServer.dotNet.buildRunner.agent.BeforeBuildPublisher" id="beforeBuildPublisher"/>
  <bean class="jetbrains.buildServer.runAs.agent.ExecutableFilePublisher" id="executableFilePublisher">
    <constructor-arg ref="beforeBuildPublisher"/>
  </bean>
  <bean class="jetbrains.buildServer.runAs.agent.SettingsProviderImpl" />

  <!-- Windows -->
  <bean class="jetbrains.buildServer.runAs.agent.CmdGenerator" id="cmdGenerator"/>
  <bean class="jetbrains.buildServer.runAs.agent.WindowsSettingsGenerator" id="windowsSettingsGenerator"/>
  <bean class="jetbrains.buildServer.runAs.agent.RunAsPlatformSpecificSetupBuilder" id="runAsWindowsSetupBuilder">
    <constructor-arg ref="beforeBuildPublisher"/>
    <constructor-arg ref="executableFilePublisher"/>
    <constructor-arg ref="windowsSettingsGenerator"/>
    <constructor-arg ref="cmdGenerator"/>
    <constructor-arg type="java.lang.String" value=".cmd"/>
  </bean>

  <!-- Unix -->
  <bean class="jetbrains.buildServer.runAs.agent.ShGenerator" id="shGenerator"/>
  <bean class="jetbrains.buildServer.runAs.agent.UnixSettingsGenerator" id="unixSettingsGenerator"/>
  <bean class="jetbrains.buildServer.runAs.agent.RunAsPlatformSpecificSetupBuilder" id="runAsUnixSetupBuilder">
    <constructor-arg ref="beforeBuildPublisher"/>
    <constructor-arg ref="unixSettingsGenerator"/>
    <constructor-arg ref="shGenerator"/>
    <constructor-arg type="java.lang.String" value=".sh"/>
  </bean>

  <bean class="jetbrains.buildServer.runAs.agent.RunAsSetupBuilder" id="runAsSetupBuilder">
    <constructor-arg ref="runAsWindowsSetupBuilder"/>
    <constructor-arg ref="runAsUnixSetupBuilder"/>
  </bean>

  <bean class="jetbrains.buildServer.runAs.agent.RunAsBuildCommandLineProcessorAdapter" id="runAsBuildCommandLineProcessorAdapter">
    <constructor-arg ref="runAsSetupBuilder"/>
  </bean>

</beans>
